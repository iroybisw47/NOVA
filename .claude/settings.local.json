{
  "permissions": {
    "allow": [
      "Bash(\"C:\\\\Users\\\\iroyb\\\\secretary-app\\\\src\\\\context\\\\AuthContext.jsx\" << 'ENDOFFILE'\nimport { createContext, useContext, useState, useEffect } from 'react'\nimport { useGoogleLogin } from '@react-oauth/google'\n\nconst AuthContext = createContext\\(\\)\n\nexport function AuthProvider\\({ children, onInitialized }\\) {\n  const [isSignedIn, setIsSignedIn] = useState\\(false\\)\n  const [accessToken, setAccessToken] = useState\\(null\\)\n  const [userId, setUserId] = useState\\(null\\)\n  const [isLoading, setIsLoading] = useState\\(true\\)\n\n  const saveToken = \\(token, expiresIn\\) => {\n    localStorage.setItem\\('nova_token', token\\)\n    localStorage.setItem\\('nova_token_expires', \\(Date.now\\(\\) + expiresIn * 1000\\).toString\\(\\)\\)\n  }\n\n  const getSavedToken = \\(\\) => {\n    const t = localStorage.getItem\\('nova_token'\\)\n    const e = localStorage.getItem\\('nova_token_expires'\\)\n    return t && e && Date.now\\(\\) < parseInt\\(e\\) - 300000 ? t : null\n  }\n\n  const clearToken = \\(\\) => {\n    localStorage.removeItem\\('nova_token'\\)\n    localStorage.removeItem\\('nova_token_expires'\\)\n  }\n\n  const login = useGoogleLogin\\({\n    onSuccess: async \\(response\\) => {\n      saveToken\\(response.access_token, response.expires_in || 3600\\)\n      setAccessToken\\(response.access_token\\)\n      setIsSignedIn\\(true\\)\n      try {\n        const userInfoR = await fetch\\('https://www.googleapis.com/oauth2/v2/userinfo', { headers: { Authorization: `Bearer ${response.access_token}` } }\\)\n        if \\(userInfoR.ok\\) {\n          const userInfo = await userInfoR.json\\(\\)\n          setUserId\\(userInfo.id\\)\n        }\n      } catch \\(e\\) { console.error\\('Could not fetch user info:', e\\) }\n      if \\(onInitialized\\) onInitialized\\(response.access_token\\)\n    },\n    scope: 'https://www.googleapis.com/auth/calendar.readonly https://www.googleapis.com/auth/calendar.events https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/tasks'\n  }\\)\n\n  const logout = \\(\\) => {\n    clearToken\\(\\)\n    setIsSignedIn\\(false\\)\n    setAccessToken\\(null\\)\n    setUserId\\(null\\)\n  }\n\n  useEffect\\(\\(\\) => {\n    const token = getSavedToken\\(\\)\n    if \\(token\\) {\n      setAccessToken\\(token\\)\n      setIsSignedIn\\(true\\)\n      // Fetch user info\n      fetch\\('https://www.googleapis.com/oauth2/v2/userinfo', { headers: { Authorization: `Bearer ${token}` } }\\)\n        .then\\(r => r.ok ? r.json\\(\\) : null\\)\n        .then\\(info => { if \\(info\\) setUserId\\(info.id\\) }\\)\n        .catch\\(\\(\\) => {}\\)\n      if \\(onInitialized\\) onInitialized\\(token\\)\n      else setIsLoading\\(false\\)\n    } else {\n      setIsLoading\\(false\\)\n    }\n  }, []\\)\n\n  const setLoading = \\(val\\) => setIsLoading\\(val\\)\n\n  return \\(\n    <AuthContext.Provider value={{\n      isSignedIn, accessToken, userId, isLoading, setLoading,\n      login, logout, saveToken, getSavedToken, clearToken\n    }}>\n      {children}\n    </AuthContext.Provider>\n  \\)\n}\n\nexport function useAuth\\(\\) {\n  const ctx = useContext\\(AuthContext\\)\n  if \\(!ctx\\) throw new Error\\('useAuth must be used within AuthProvider'\\)\n  return ctx\n}\nENDOFFILE)",
      "Bash(npx vite build:*)",
      "Bash(del \"C:\\\\Users\\\\iroyb\\\\secretary-app\\\\src\\\\App.css\")",
      "Bash(del \"C:\\\\Users\\\\iroyb\\\\secretary-app\\\\src\\\\index.css\")",
      "Bash(del \"C:\\\\Users\\\\iroyb\\\\secretary-app\\\\src\\\\jarvis.jsx\")",
      "Bash(git init:*)",
      "Bash(git branch:*)"
    ]
  }
}
